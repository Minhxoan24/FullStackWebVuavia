{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Minh\\\\Desktop\\\\FullStackWebVuavia\\\\frontend\\\\src\\\\Context\\\\AuthContext.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, createContext } from \"react\";\nimport AuthService from \"../Services/AuthService\";\nimport UserService from \"../Services/UserService\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext();\nconst AuthProvider = ({\n  element\n}) => {\n  _s();\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [token, setToken] = useState(localStorage.getItem(\"token\"));\n  useEffect(() => {\n    if (token) {\n      UserService.getProfile().then(setUser).catch(() => setUser(null));\n    }\n  }, [token]);\n  const login = async credentials => {\n    setLoading(true);\n    try {\n      const data = await AuthService.login(credentials);\n      localStorage.setItem(\"access_token\", data.access_token);\n      localStorage.setItem(\"refresh_token\", data.refresh_token);\n      setToken(data.access_token);\n    } catch (error) {\n      console.error(\"Login failed:\", error);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const logout = async () => {\n    await AuthService.logout();\n    localStorage.removeItem(\"access_token\");\n    localStorage.removeItem(\"refresh_token\");\n    setToken(null);\n    setUser(null);\n  };\n  const register = async userInfo => {\n    setLoading(true);\n    try {\n      await AuthService.register(userInfo);\n      localStorage.setItem(\"access_token\", userInfo.access_token);\n      localStorage.setItem(\"refresh_token\", userInfo.refresh_token);\n      setToken(userInfo.access_token);\n    } catch (error) {\n      console.error(\"Registration failed:\", error);\n    } finally {\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      user,\n      loading,\n      login,\n      logout,\n      register\n    },\n    children: element\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 50,\n    columnNumber: 9\n  }, this);\n};\n_s(AuthProvider, \"CqPWeQPIAZcxf1k81ln9DyaZT80=\");\n_c = AuthProvider;\nexport default AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","useState","useEffect","createContext","AuthService","UserService","jsxDEV","_jsxDEV","AuthContext","AuthProvider","element","_s","user","setUser","loading","setLoading","token","setToken","localStorage","getItem","getProfile","then","catch","login","credentials","data","setItem","access_token","refresh_token","error","console","logout","removeItem","register","userInfo","Provider","value","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/Minh/Desktop/FullStackWebVuavia/frontend/src/Context/AuthContext.jsx"],"sourcesContent":["import React, { useState, useEffect, createContext } from \"react\";\r\nimport AuthService from \"../Services/AuthService\";\r\nimport UserService from \"../Services/UserService\";\r\nexport const AuthContext = createContext();\r\nconst AuthProvider = ({ element }) => {\r\n    const [user, setUser] = useState(null);\r\n    const [loading, setLoading] = useState(true);\r\n    const [token, setToken] = useState(localStorage.getItem(\"token\"));\r\n\r\n    useEffect(() => {\r\n        if (token) {\r\n            UserService.getProfile().then(setUser).catch(() => setUser(null))\r\n\r\n        }\r\n    }, [token]);\r\n    const login = async (credentials) => {\r\n        setLoading(true);\r\n        try {\r\n            const data = await AuthService.login(credentials);\r\n            localStorage.setItem(\"access_token\", data.access_token);\r\n            localStorage.setItem(\"refresh_token\", data.refresh_token);\r\n            setToken(data.access_token);\r\n        } catch (error) {\r\n            console.error(\"Login failed:\", error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n    const logout = async () => {\r\n        await AuthService.logout();\r\n        localStorage.removeItem(\"access_token\");\r\n        localStorage.removeItem(\"refresh_token\");\r\n        setToken(null);\r\n        setUser(null);\r\n    };\r\n    const register = async (userInfo) => {\r\n        setLoading(true);\r\n        try {\r\n            await AuthService.register(userInfo);\r\n            localStorage.setItem(\"access_token\", userInfo.access_token);\r\n            localStorage.setItem(\"refresh_token\", userInfo.refresh_token);\r\n            setToken(userInfo.access_token);\r\n        } catch (error) {\r\n            console.error(\"Registration failed:\", error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n    return (\r\n        <AuthContext.Provider value={{ user, loading, login, logout, register }}>\r\n            {element}\r\n        </AuthContext.Provider>\r\n    );\r\n\r\n};\r\n\r\nexport default AuthProvider;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}